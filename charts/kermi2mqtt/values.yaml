# Default values for kermi2mqtt
# This is a YAML-formatted file.

replicaCount: 1

image:
  repository: ghcr.io/jr42/kermi2mqtt
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use
  name: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext:
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 10m
    memory: 64Mi

nodeSelector: {}

tolerations: []

affinity: {}

# -- Kermi2mqtt configuration
config:
  # -- Log level (DEBUG, INFO, WARNING, ERROR)
  logLevel: INFO

  # -- HTTP API connection settings (recommended, default)
  http:
    # -- Kermi X-Center hostname or IP
    host: ""
    # -- HTTP port
    port: 80
    # -- Optional password (typically last 4 digits of serial number)
    password: ""
    # -- Request timeout in seconds
    timeout: 10.0

  # -- Modbus connection settings (legacy, use http instead)
  modbus:
    # -- Kermi X-Center hostname or IP
    host: ""
    # -- Modbus TCP port
    port: 502
    # -- Connection mode (tcp or rtu)
    mode: tcp

  # -- MQTT broker settings
  mqtt:
    # -- MQTT broker hostname
    host: ""
    # -- MQTT broker port
    port: 1883
    # -- Enable TLS
    tlsEnabled: false
    # -- Skip TLS certificate verification (for self-signed certs)
    tlsInsecure: false
    # -- Base topic for all messages
    baseTopic: kermi

  # -- Integration settings
  integration:
    # -- Connection type: "http" (recommended) or "modbus" (legacy)
    connectionType: http
    # -- Device identifier for unique entity IDs (auto-detected if not set)
    # -- IMPORTANT: Set this to avoid duplicate entities in Home Assistant
    deviceId: ""

  # -- Home Assistant integration
  homeAssistant:
    # -- Enable HA MQTT discovery
    discoveryEnabled: true
    # -- HA discovery topic prefix
    discoveryPrefix: homeassistant

  # -- Polling interval in seconds
  pollingInterval: 30

# -- MQTT authentication (stored in Secret)
mqttAuth:
  # -- Create secret for MQTT credentials
  create: true
  # -- Use existing secret (if create is false)
  existingSecret: ""
  # -- Key in secret for username
  usernameKey: username
  # -- Key in secret for password
  passwordKey: password
  # -- MQTT username (only used if create is true)
  username: ""
  # -- MQTT password (only used if create is true)
  password: ""

# -- Extra environment variables
extraEnv: []
#  - name: TZ
#    value: Europe/Berlin

# -- Extra volumes
extraVolumes: []

# -- Extra volume mounts
extraVolumeMounts: []
